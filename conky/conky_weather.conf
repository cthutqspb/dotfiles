-- Conky, a system monitor https://github.com/brndnmtthws/conky
--
-- This configuration file is Lua code. You can write code in here, and it will
-- execute when Conky loads. You can use it to generate your own advanced
-- configurations.
--
-- Try this (remove the `--`):
--
--   print("Loading Conky config")
--
-- For more on Lua, see:
-- https://www.lua.org/pil/contents.html

-- #${execi 1000 curl wttr.in/Saint+Petersburg?T&q&lang=ru | sed -n '3,7{s/\d27\[0-9;]*m//g;s/^..//;s/ *$//;p}' | ~/.config/conky/ansi2conky}

conky.config = {
    alignment = 'top_right',
    xinerama_head = 2,
    background = true,
    border_width = 1,
    cpu_avg_samples = 2,
    default_color = 'dee1f0',
    default_outline_color = 'white',
    default_shade_color = 'white',
    double_buffer = true,
    draw_borders = false,
    draw_graph_borders = true,
    draw_outline = false,
    draw_shades = false,
    extra_newline = false,
    font = 'Terminess Nerd Font Mono:size=12',
    gap_x = 750,
    gap_y = 300,
    minimum_height = 5,
    minimum_width = 5,
    net_avg_samples = 2,
    no_buffers = true,
    out_to_console = false,
    out_to_ncurses = false,
    out_to_stderr = false,
    out_to_x = true,
    own_window = true,
    own_window_class = 'Conky',
    own_window_transparent = true,
    own_window_argb_visual = true,
    own_window_type = 'normal',
    own_window_hints = 'undecorated,below,sticky,skip_taskbar,skip_pager',
    show_graph_range = false,
    show_graph_scale = false,
    stippled_borders = 0,
    update_interval = 1.0,
    uppercase = false,
    use_spacer = 'none',
    use_xft = true,
    
    color1 = 'dee1f0',
    color2 = 'ab9639',
    color3 = '969cb3',
    color4 = '21a1c8'
    
    
    
}


-- ${texeci 1000 curl -H "Accept-Language: ru" https://wttr.in/Saint+Petersburg_?n_?Q_T | sed '$d'}
-- ${execi 1000 curl 'https://api.openweathermap.org/data/2.5/forecast?units=metric&q=Saint+Petersburg,ru&lang=ru&APPID=5f75f18044a95faa8207a8d99815447d' >> ~/.config/conky/forecast.json}
-- ${execi 1000 (jq -r '.' ~/.config/conky/weather.json)}
-- ${execi 1000 (jq -r '.' ~/.config/conky/weather.json)}   //> ~/.config/conky/weather.json |  --output ~/.config/conky/current.png

-- ${execi 10  curl "https://openweathermap.org/img/wn/${jq -r .weather[0].icon ~/.config/conky/weather.json}@2x.png" }

-- ${execi 10 curl "https://openweathermap.org/img/wn/"$(jq -r .list[13].weather[0].icon ~/.config/conky/forecast.json)"@2x.png" --output ~/.config/conky/day_1.png}
-- ${image ~/.config/conky/day_1.png -p -10, 385 -s 128x128}
-- ${offset 120}${voffset 100}${execi 100 date --date $(jq -r .list[8].dt'+'.list[8].timezone ~/.config/conky/forecast.json | jq -r todate) "+%d.%m %a"}
-- ${voffset 16}${color3}${execi 10 jq -r .list[13].weather[0].description ~/.config/conky/forecast.json | awk ' { $0=toupper(substr($0,1,1))substr($0,2); print } '}
-- ${color3}${font Terminess Nerd Font Mono Bold:size=18}  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 10 jq -r .list[13].main.temp ~/.config/conky/-- -- -- forecast.json | jq -c 'round'}
-- ${color3}${font Terminess Nerd Font Mono Bold:size=18}󰖔  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 10 jq -r .list[17].main.temp ~/.config/conky/-- -- -- forecast.json | jq -c 'round'}
-- ${color3}${font Terminess Nerd Font Mono Bold:size=18}󰖝  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 10 jq -r .list[13].wind.speed ~/.config/conky/-- -- -- forecast.json | jq -c 'round'} м/с 
-- ${execi 1000 curl 'https://api.openweathermap.org/data/2.5/forecast?units=metric&q=Saint+Petersburg,ru&lang=ru&APPID=5f75f18044a95faa8207a8d99815447d' > ~/.config/conky/forecast.json}
-- ${offset 160}${color3}${font Terminess Nerd Font Mono Bold:size=18}󰖔  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 20 jq -r .list[8].main.temp ~/.config/conky/forecast.json | jq -c 'round'}°

conky.text = [[

${execi 200 curl 'https://api.openweathermap.org/data/2.5/weather?units=metric&q=Saint+Petersburg,ru&lang=ru&APPID=5f75f18044a95faa8207a8d99815447d' > ~/.config/conky/weather.json}

${offset 20}${voffset 60}${color3}${font Terminess Nerd Font Mono:size=18}${color2}${execi 200 date $(jq -r .dt'+'.timezone ~/.config/conky/weather.json) "+%d.%m %a"}
${execi 20 curl "https://openweathermap.org/img/wn/"$(jq -r .weather[0].icon ~/.config/conky/weather.json)"@2x.png" > ~/.config/conky/current.png}
${image ~/.config/conky/current.png -p 0, 0 -s 128x128}
${offset 160}${voffset -185}${font Terminess Nerd Font Mono:size=18}${color3}${execi 20 jq -r .weather[0].description ~/.config/conky/weather.json | awk ' { $0=toupper(substr($0,1,1))substr($0,2); print } '} 
${offset 160}${color3}${font Terminess Nerd Font Mono Bold:size=18}  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 20 jq -r .main.temp ~/.config/conky/weather.json | jq -c 'round'}°
${offset 160}${color3}Ощущается как ${color2}${execi 20 jq -r .main.feels_like ~/.config/conky/weather.json | jq -c 'round'}°
${offset 160}${color3}${font Terminess Nerd Font Mono Bold:size=18}  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 20 jq -r .main.humidity ~/.config/conky/weather.json}%
${offset 160}${color3}${font Terminess Nerd Font Mono Bold:size=18}󰖝  ${font Terminess Nerd Font Mono:size=18}${color2}${execi 20 jq -r .wind.speed ~/.config/conky/weather.json | jq -c 'round'} м/с${font}

]]
